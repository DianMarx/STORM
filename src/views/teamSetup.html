<!DOCTYPE html>
<html>
<script src="APIs/jquery-2.1.4.min.js"></script>
<head lang="en">
    <meta charset="UTF-8">
    <title>Team Setup</title>

    <link rel="stylesheet" href="APIs/jquery-ui-1.11.4.custom/jquery-ui.min.css">
    <script src="APIs/jquery-ui-1.11.4.custom/external/jquery/jquery.js"></script>
    <script src="APIs/jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="style/css.css">

    <script src="scripts/dbInteraction.js"></script>

    <style>
	section {
    width: 80%;
    height: 500px;
    background:#333;
    margin: auto;
    padding: 10px;
}
	</style>

    <script>

        $(document).ready(function(e) {

			$('#randomize').click(function(e) {
				var max = 5;
                //var i = $('.names').children().length;
				//alert("yooo");
				$('.names').children().each(function(index, element) {
                    var randm = Math.floor(Math.random() * (4-1) + 1);
					//alert(randm);
					var done = false;
					while(done != true){
					switch(randm){
					case 1:if($('.first').children().length < max){
					 $(element).appendTo(".first"); done = true; 
					 if($('.first').children().length == max) max = 4;
					 break;} else max = 4;
					case 2: if($('.second').children().length < max){
					 $(element).appendTo(".second"); done = true; 
					 if($('.second').children().length == max) max = 4;
					 break;}else  max = 4; 
					case 3: if($('.third').children().length < max){
					 $(element).appendTo(".third");done = true;
					 if($('.third').children().length == max) max = 4;
					  break;}else max = 4;
					  }
					  randm = Math.floor(Math.random() * (4-1) + 1);
					}
                });
            });
        });
	
        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
        }

        function drop(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            ev.target.appendChild(document.getElementById(data));
        }

        $(function() {
            $( "input[type=submit], a, button, input[type=file]" ).button();

            $( "#dialog" ).dialog({
                autoOpen: false,
                width: 400,
                buttons: [
                    {
                        text: "Ok",
                        click: function() {
                            $( this ).dialog( "close" );
                        }
                    }
                ]
            });;
        });

        if (window.File && window.FileReader && window.FileList && window.Blob) {
            // Great success! All the File APIs are supported.
        } else {
            alert('The File APIs are not fully supported in this browser.');
        }


	
    </script>
</head>
<body>
    <div class="header">
        <h2 class="headerMessages">Team Setup</h2>
        <img id="logo" src="images/Storm.png" alt="STORM Logo" height="80" />
    </div>
    <div class="main">
        <div class="teamSetup">
            <div class="members">
                <div id="subjects" class="names" ondrop="drop(event)" ondragover="allowDrop(event)">
                    <%for(var i = 0; i < subjects.length; i++){%>
                    <div class="subject" id=<%= i %> draggable="true" ondragstart="drag(event)"><%=subjects[i].name%>
                    </div> <% } %>
                </div>
                Input from .CSV file: <input type="file" id="CSVInput" name="file" accept=".csv"/>
            </div>


            <button name="Randomize" id="randomize">Randomize</button>
            <div class="teams">
                <div class="teamTables first" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                <div class="teamTables second" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                <div class="teamTables third" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
        </div>
    </div>

    <div id="dialog" title="Basic dialog">
        <div id="dialogText"></div>
    </div>

    <br>

</body>
<script src="scripts/inputCSV.js"></script>
<script>
</script>
</html>